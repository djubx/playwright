<-- START_DESCRIPTION -->

# Openpay BBVA Flutter Package
================================

The `openpay_bbva` Flutter package is a library that allows developers to integrate Openpay's payment gateway into their Flutter applications. Openpay is a popular payment platform in Mexico that provides a secure and reliable way to process transactions.

## When to Use This Package
---------------------------

This package is ideal for developers who want to create e-commerce or m-commerce applications that require payment processing in Mexico. It provides a seamless and secure way to integrate Openpay's payment gateway into your Flutter application.

## Features
------------

*   Supports payment with credit/debit cards and other payment methods
*   Provides a secure and reliable way to process transactions
*   Easy to integrate into your Flutter application

<-- END_DESCRIPTION -->

<-- START_TUTORIAL -->

# Tutorial: Setting Up and Using the Openpay BBVA Flutter Package
=============================================================

## Step 1: Add the Package to Your Project
-----------------------------------------

To use the `openpay_bbva` package, you need to add it to your project's `pubspec.yaml` file. You can do this by adding the following line under the `dependencies` section:

```yml
dependencies:
  flutter:
    sdk: flutter
  openpay_bbva: ^1.0.0
```

Then, run `flutter pub get` in your terminal to get the package.

## Step 2: Import the Package
---------------------------

To use the package, you need to import it into your Dart file. You can do this by adding the following line at the top of your file:

```dart
import 'package:openpay_bbva/openpay_bbva.dart';
```

## Step 3: Set Up the Payment Gateway
-------------------------------------

To set up the payment gateway, you need to create an instance of the `OpenpayBBVA` class and pass your merchant ID and public key to the constructor.

```dart
OpenpayBBVA openpayBBVA = OpenpayBBVA(
  merchantId: 'your_merchant_id',
  publicKey: 'your_public_key',
);
```

## Step 4: Create a Payment Token
-------------------------------

To create a payment token, you need to call the `createPaymentToken` method and pass the payment method and amount to the method.

```dart
String paymentToken = await openpayBBVA.createPaymentToken(
  paymentMethod: 'card',
  amount: 100.0,
);
```

## Step 5: Process the Payment
---------------------------

To process the payment, you need to call the `processPayment` method and pass the payment token to the method.

```dart
bool paymentResult = await openpayBBVA.processPayment(
  paymentToken: paymentToken,
);
```

<-- END_TUTORIAL -->

<-- START_MAIN -->

```dart
import 'package:flutter/material.dart';
import 'package:openpay_bbva/openpay_bbva.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Openpay BBVA Demo',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: MyHomePage(),
    );
  }
}

class MyHomePage extends StatefulWidget {
  @override
  _MyHomePageState createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> {
  final _formKey = GlobalKey<FormState>();
  String _paymentMethod = 'card';
  double _amount = 100.0;
  String _paymentToken = '';
  bool _paymentResult = false;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Openpay BBVA Demo'),
      ),
      body: Padding(
        padding: const EdgeInsets.all(20.0),
        child: Form(
          key: _formKey,
          child: Column(
            children: [
              // Payment method dropdown
              DropdownButtonFormField(
                value: _paymentMethod,
                onChanged: (value) {
                  setState(() {
                    _paymentMethod = value;
                  });
                },
                items: [
                  DropdownMenuItem(
                    child: Text('Card'),
                    value: 'card',
                  ),
                  DropdownMenuItem(
                    child: Text('Other'),
                    value: 'other',
                  ),
                ],
              ),
              // Amount text field
              TextFormField(
                initialValue: _amount.toString(),
                onChanged: (value) {
                  setState(() {
                    _amount = double.parse(value);
                  });
                },
                decoration: InputDecoration(
                  labelText: 'Amount',
                ),
              ),
              // Create payment token button
              ElevatedButton(
                onPressed: () async {
                  // Create payment token
                  OpenpayBBVA openpayBBVA = OpenpayBBVA(
                    merchantId: 'your_merchant_id',
                    publicKey: 'your_public_key',
                  );
                  String paymentToken = await openpayBBVA.createPaymentToken(
                    paymentMethod: _paymentMethod,
                    amount: _amount,
                  );
                  setState(() {
                    _paymentToken = paymentToken;
                  });
                },
                child: Text('Create Payment Token'),
              ),
              // Process payment button
              ElevatedButton(
                onPressed: () async {
                  // Process payment
                  OpenpayBBVA openpayBBVA = OpenpayBBVA(
                    merchantId: 'your_merchant_id',
                    publicKey: 'your_public_key',
                  );
                  bool paymentResult = await openpayBBVA.processPayment(
                    paymentToken: _paymentToken,
                  );
                  setState(() {
                    _paymentResult = paymentResult;
                  });
                },
                child: Text('Process Payment'),
              ),
              // Payment result text
              Text(
                _paymentResult ? 'Payment successful' : 'Payment failed',
              ),
            ],
          ),
        ),
      ),
    );
  }
}

// The application flow is as follows:
// 1. The user selects a payment method from the dropdown.
// 2. The user enters an amount in the text field.
// 3. The user clicks the "Create Payment Token" button.
// 4. The application creates a payment token using the Openpay BBVA API.
// 5. The user clicks the "Process Payment" button.
// 6. The application processes the payment using the Openpay BBVA API.
// 7. The application displays the payment result to the user.

// Note: This is a basic example and you should handle errors and exceptions properly in a real-world application.

<-- END_MAIN -->